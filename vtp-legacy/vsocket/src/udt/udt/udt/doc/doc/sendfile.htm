<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>UDT Reference</title>
</head>

<body>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" width="100%" id="AutoNumber1" bgcolor="#99CCFF" bordercolor="#99CCFF">
  <tr>
    <td width="100%"><font face="Verdana" size="2"><i>&nbsp;UDT Reference: CUDT 
    Methods</i></font></td>
  </tr>
</table>
<h1 style="margin-bottom: 0"><font face="Verdana" size="4">sendfile</font></h1>
<p><font face="Verdana" size="2">The <b>sendfile </b>method sends out a file 
stream.</font></p>
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" width="100%" id="AutoNumber2" bgcolor="#C0C0C0" bordercolor="#C0C0C0">
  <tr>
    <td width="100%">
    <p style="margin-top: 0; margin-bottom: 0"><font size="1" face="Courier New">
    int sendfile(<br>
&nbsp;&nbsp; ifstream&amp; <font color="#FFFFFF">ifs</font>,</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font face="Courier New" size="1">&nbsp;&nbsp; const long long&amp;
    <font color="#FFFFFF">offset</font>,</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font face="Courier New" size="1">&nbsp;&nbsp; const long long&amp;
    <font color="#FFFFFF">size</font><br>
    );</font></p>
    </td>
  </tr>
</table>
<h4><font face="Verdana" size="2">Parameters</font></h4>
<dl>
  <dt><font face="Verdana" size="2"><i>ifs</i> </font></dt>
  <dd><font face="Verdana" size="2">[in] The input file stream from which the 
  data will be read and sent.</font></dd>
  <dt>&nbsp;</dt>
  <dt><i><font face="Verdana" size="2">offset</font></i><font face="Verdana" size="2"> </font></dt>
  <dd><font face="Verdana" size="2">[in] The position from where data will be 
  sent.</font></dd>
</dl>
<dl>
  <dt><i><font face="Verdana" size="2">size</font></i><font face="Verdana" size="2"> </font></dt>
  <dd><font face="Verdana" size="2">[in] The total length of data to be sent. </font></dd>
</dl>
<h4><font face="Verdana" size="2">Return Values</font></h4>
<p><font face="Verdana" size="2">Actual size of data sent.</font></p>
<h4><font face="Verdana" size="2">Exceptions</font></h4>
<p style="margin-bottom: 0"><font face="Verdana" size="2">A
<a href="cudtexception.htm">CUDTException</a> exception can be threw out if the UDT entity is not connected 
or the connection has been broken, or any file stream exception arises for <i>
ifs</i>. Specially, if <i>size</i> is greater than the actual file size, 
exceptions will arise. Application should be responsible to check the file size.</font></p>
<H4><font face="Verdana" size="2">Description</font></H4>
<P><font face="Verdana" size="2">The <b>sendfile </b>method sends data from a 
file stream. To send a whole file, simply set the <i>offset</i> to 0, and the<i> 
size</i> to the actual file size.</font></P>
<P><font face="Verdana" size="2">The data sending and receiving are orthogonal, 
i.e., the peer side can use either <a href="recv.htm">recv</a> or
<a href="recvfile.htm">recvfile</a> to receive data, no matter <a href="send.htm">
send</a> or <b>sendfile</b> is used at the other side.</font></P>
<P><font face="Verdana" size="2"><b>sendfile</b> is always in blocking mode. The
<a href="opt.htm">UDT_SNDSYN</a> option only affects <a href="send.htm">send</a>.</font></P>
<P><font face="Verdana" size="2"><font color="#008000">Zero</font> or negative 
value is allowed for <i>size</i>. In such situation, the method returns immediately.</font></P>
<h4><font face="Verdana" size="2">Notes</font></h4>
<P><font face="Verdana" size="2">The <u>long long</u> type parameters of offset 
and size are actually 64 bit integers. They are defined as <i>
<font color="#808000">__int64</font></i> in the implementation, and <i>
<font color="#808000">__int64</font></i> is defined as <u>long long</u> on most 
of systems. See <a href="migrate.htm">migration guide</a> for detail. Similarly, 
all <u>int</u> type parameter are actually 32 bit integers, which is defined as
<font color="#808000"><i>__int32 </i></font>in the source codes.</font></P>
<H4><font face="Verdana" size="2">Examples</font></H4>
<p><font face="Verdana" size="2">The following codes show how to send a whole 
file to the remote node using UDT:</font></p>
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" width="100%" id="AutoNumber2" bgcolor="#C0C0C0" bordercolor="#C0C0C0">
  <tr>
    <td width="100%">
    <p style="margin-top: 0; margin-bottom: 0"><font size="1" face="Courier New">
    CUDT udt;</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font face="Courier New" size="1">...</font></p>
    <p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
    <p style="margin-top: 0; margin-bottom: 0"><font size="1" face="Courier New">
    ifstream&amp; ifs(&quot;largefile.dat&quot;);</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">ifs.seekg(0, ios::end);</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">int size = ifs.tellg();</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">ifs.seekg(0, ios::beg);</font></p>
    <p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">try</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">{</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">&nbsp;&nbsp; sender-&gt;sendfile(ifs, 0, 
    size);</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">}</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">catch (CUDTException e)</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">{</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font face="Courier New" size="1">&nbsp;&nbsp; // process error...</font></p>
    <p style="margin-top: 0; margin-bottom: 0">
    <font size="1" face="Courier New">}</font></td>
  </tr>
</table>
<H4><font face="Verdana" size="2">See Also</font></H4>
<P><font face="Verdana" size="2"><b>
<a href="send.htm">send</a>, <a href="recv.htm">recv</a>, <a href="recvfile.htm">recvfile</a></b></font></P>

</body>

</html>
